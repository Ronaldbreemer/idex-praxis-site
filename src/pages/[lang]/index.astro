---
import BaseLayout from "../../layouts/BaseLayout.astro";
import CTA from "../../components/CTA.astro";
import * as i18n from "../../lib/i18n";

export const prerender = true;
export const getStaticPaths = () =>
  i18n.SUPPORTED.map((lang) => ({ params: { lang } }));

const lang = i18n.langFromParams(Astro.params);
const c = i18n.t(lang);
const herkenbaarSentences = c.home.herkenbaarBody
  .split(". ")
  .map((s) => s.trim())
  .filter(Boolean);
const herkenbaarParts = herkenbaarSentences.flatMap((sentence, index) => {
  if (index === 0 && sentence.includes("? ")) {
    const [q, rest] = sentence.split("? ");
    return [`${q}?`, rest];
  }
  if (index === 1 && sentence.includes(", zodat ")) {
    const [main, payoff] = sentence.split(", zodat ");
    return [main, `zodat ${payoff}`];
  }
  return [sentence];
});
const herkenbaarBulletParts = herkenbaarParts.map((s) => (s.endsWith(".") ? s : `${s}.`));
if (herkenbaarBulletParts.length > 3) {
  const rest = herkenbaarBulletParts.slice(3).join(" ");
  herkenbaarBulletParts[2] = `${herkenbaarBulletParts[2]} ${rest}`.trim();
  herkenbaarBulletParts.length = 3;
}
const herkenbaarBullets = herkenbaarBulletParts;
const metaTitle =
  lang === "nl"
    ? "Praktijksoftware: cliëntenbeheer & trajectondersteuning automatiseren | IDEX Praxis"
    : c.meta.title;
const metaDesc =
  lang === "nl"
    ? "Praktijksoftware voor cliëntenbeheer en trajectondersteuning, veilig en overdraagbaar. Intake via mail of telefoon."
    : c.meta.desc;
---
<BaseLayout title={metaTitle} description={metaDesc} lang={lang}>
  <section class="section hero">
    <div class="container">
      <div class="hero-inner">
        <div>
          <div class="badge">
            <span class="badge-dot"></span>
            <span class="kicker">{c.home.heroKicker}</span>
          </div>
          <h1 class="hero-title" style="margin-top:16px;">{c.home.heroTitle}</h1>
          <p class="hero-sub">{c.home.heroSub}</p>
          <small style="display:block; margin-top:10px; opacity:.8;">{c.home.heroForWho}</small>

          <div class="btn-row">
            <a class="btn btn-primary" href={i18n.withLang(lang, "contact")}>{c.cta.kennismaking}</a>
            <a class="btn" href={i18n.withLang(lang, "aanbod")}>{c.cta.scan}</a>
          </div>
          <small style="display:block; margin-top:8px; opacity:.7;">{c.home.scanHint}</small>

          <div class="stat-row">
            {c.home.stats.map((s) => (
              <div class="stat">
                <strong>{s.n}</strong>
                <span>{s.l}</span>
              </div>
            ))}
          </div>
        </div>

        <div class="hero-orb">
          <div class="mini-ui">
            <div class="mini-ui-header">
              <div class="mini-ui-dot"></div>
              <strong>{c.home.heroOrbUi.header}</strong>
              <span>{c.home.heroOrbUi.time}</span>
            </div>
            <div class="mini-ui-body">
              <div class="mini-row">
                <div class="mini-label">{c.home.heroOrbUi.clientLabel}</div>
                <div class="mini-value">{c.home.heroOrbUi.clientValue}</div>
              </div>
              <div class="mini-row">
                <div class="mini-label">{c.home.heroOrbUi.goalLabel}</div>
                <div class="mini-value">{c.home.heroOrbUi.goalValue}</div>
              </div>
              <div class="mini-row">
                <div class="mini-label">{c.home.heroOrbUi.statusLabel}</div>
                <div class="mini-pill">{c.home.heroOrbUi.statusValue}</div>
              </div>
            </div>
            <div class="mini-ui-footer">
              {c.home.heroOrbUi.steps.map((step) => (
                <div class="mini-step">
                  <span class="mini-step-dot"></span>
                  {step}
                </div>
              ))}
            </div>
          </div>
        </div>
      </div>

      <div class="grid cards-3" style="margin-top:12px;">
        {c.home.promises.map((p) => (
          <div
            class="card"
            style={
              p.t === c.home.promises[1].t
                ? "border-top:4px solid rgba(242,210,27,.75); background: linear-gradient(180deg, rgba(255,255,255,.98), rgba(255,255,255,.78));"
                : "border-top:3px solid rgba(242,210,27,.45);"
            }
          >
            <h3>{p.t}</h3>
            <p style="margin-top:10px;">{p.d}</p>
          </div>
        ))}
      </div>
    </div>
  </section>

  <section class="section" style="padding-top:36px;">
    <div class="container split" style="align-items:flex-start;">
      <div class="card" style="border-top:3px solid rgba(31,174,96,.35); align-self:flex-start;">
        <div class="kicker">{c.home.herkenbaarTitle}</div>
        <h2 style="margin-top:10px;">{c.home.herkenbaarHeading}</h2>
        <ul class="list" style="margin-top:6px;">
          {herkenbaarBullets.map((b) => (
            <li class="li">
              <span class="check" aria-hidden="true"></span>
              <p>{b}</p>
            </li>
          ))}
        </ul>
      </div>

      <div class="card" style="border-top:3px solid rgba(31,174,96,.35);">
        <div class="kicker">{c.home.watJeKrijgtTitle}</div>
        <h3 style="margin-top:10px;">{c.home.watJeKrijgtIntro}</h3>
        <ul class="list" style="margin-top:12px;">
          {c.home.watJeKrijgtBullets.map((b) => (
            <li class="li">
              <span class="check" aria-hidden="true"></span>
              <p>{b}</p>
            </li>
          ))}
        </ul>

        <details class="tooltip">
          <summary>{c.home.tooltipTitle}</summary>
          <p style="margin-top:10px;">{c.home.tooltipBody}</p>
        </details>
      </div>
    </div>
  </section>

  <section class="section">
    <div class="container">
      <div class="card">
        <div class="kicker">{c.home.hoeWerktTitle}</div>
        <h2 style="margin-top:10px;">{c.home.hoeWerktHeading}</h2>

        <div class="grid" style="margin-top:16px;">
          {c.home.hoeWerktSteps.map((s) => (
            <div class="card" style="box-shadow:none; border-top:3px solid rgba(31,174,96,.35);">
              <h3>{s[0]}</h3>
              <p style="margin-top:8px;">{s[1]}</p>
            </div>
          ))}
        </div>

        <div class="btn-row">
          <a class="btn btn-primary" href={i18n.withLang(lang, "aanbod")}>{c.cta.aanbod}</a>
          <a class="btn" href={i18n.withLang(lang, "cases")}>{c.cta.cases}</a>
          <a class="btn" href={i18n.withLang(lang, "faq")}>{c.cta.faq}</a>
        </div>
      </div>
    </div>
  </section>

  <section class="section">
    <div class="container split">
      <div class="card">
        <div class="kicker">{c.home.prijsTitle}</div>
        <h2 style="margin-top:10px;">{c.home.prijsHeading}</h2>
        <p style="margin-top:12px;">{c.home.prijsBody}</p>
      </div>
      <div class="card">
        <div class="kicker">{c.home.securityTitle}</div>
        <h2 style="margin-top:10px;">{c.home.securityHeading}</h2>
        <p style="margin-top:12px;">{c.home.securityBody}</p>
      </div>
    </div>
  </section>

  <CTA
    lang={lang}
    title={c.home.bottomCtaTitle}
    body={c.home.bottomCtaBody}
    primaryHref={i18n.withLang(lang, "contact")}
    primaryLabel={c.cta.kennismaking}
    secondaryHref={i18n.withLang(lang, "aanbod")}
    secondaryLabel={c.cta.scan}
  />
</BaseLayout>
